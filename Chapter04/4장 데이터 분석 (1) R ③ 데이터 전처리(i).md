## 4장 데이터 분석  (1) R  ③ 데이터 전처리(i)

​     

#### 1) 데이터 불러오기 



데이터를 불러오기 전에 작업경로를 확인해야 합니다. 데이터가 있는 폴더로 작업경로가 설정되었다면 데이터가 있는 파일명만 적으면 되지만, 작업경로가 다르면 절대경로를 사용해야 합니다.



```R
read.table(“파일명”, header=TRUE, sep=“기호”, stringAsFactors=FALSE, na.strings=“기호”)

# csv와 txt 파일을 읽어오는 함수, read.csv보다 느림(인자는 아래 read.csv( ) 참조)
```

​     

특히 .txt,  .csv 파일이라면 헤더가 있는지, 구분자는 무엇인지 확인해야 합니다.

​     

```R
read.csv(“파일명”, header=TRUE, sep=“기호”, stringsAsFactors=FALSE, strip.white=TRUE, na.strings=“기호”)

# csv와 txt 파일을 읽어오는 함수(URL을 넣어도 된다), read.table보다 빠름

# header = 첫 줄에 필드명이 있는 경우 TRUE

# sep = csv 파일에서 데이터를 구분하는 기호(, ; \t \n 등)

# stringsAsFactors = 문자 데이터를 부르면 자동으로 Factor로 로딩되므로 FALSE를 권장

# strip.white = 데이터를 불러올 때 좌우로 공백 발생하는 것 막기

# na.strings = 결측치를 NA 이외에 다른 기호로 표현하고 싶을 때 사용하는 인수
```

​     

```R
# Tip

attach(데이터명)  <->  detach(데이터명)

# attach 함수를 사용하면 detach 함수 입력 전까지 데이터를 저장한 변수명을 사용하지 않아도 자동으로 그 데이터를 사용한다고 인식합니다. 컬럼 단위로 작업을 할 때 유용합니다.
```

​     

 

#### 2) 데이터가 잘 들어왔는지 확인하기



```R
print(변수명)  # max.print가 1000이므로 일정량 이상이면 그 이하는 생략됨

View(변수명) ★
```

​     

```R
head(변수명, 숫자)   # 기본적으로 앞쪽의 6행에 해당하는 모든 데이터를 출력함
                   # 숫자를 넣으면 그 숫자에 해당하는 행만큼 데이터를 출력함

tail(변수명, 숫자)   # 기본적으로 뒤쪽의 6행에 해당하는 모든 데이터를 출력함
                   # 숫자를 넣으면 그 숫자에 해당하는 행만큼 데이터를 출력함
```

​     

```R
names(변수명)  # 데이터의 컬럼명(header)에 해당하는 사항을 출력함

str(변수명)  # R에서 기본적으로 제공하는 구조 확인 함수, 데이터 유형이나 앞쪽에 위치한 실제 데이터를 보여줌(특정 컬럼을 대상으로 입력할 수 있음)

attributes(변수명)  # row명, column명, 데이터 구조가 출력되는 함수
```

​     



#### 3) factor 변환 - 데이터 전처리1



```R
people$sex <- factor(people$sex, level=c(0, 1), labels=c("Man", "Woman"))

# sex열에는 0과 1이 있지만, 무엇을 의미하는지 모르므로 Man과 Woman이라는 범주형 데이터임을 명시적으로 표시함

# factor(데이터, level=데이터에 있는 실제값, labels=실제값이 무엇을 의미하는가?)
```

​     



#### 4) 데이터 조회

​     

열을 제한하는 경우 = 인덱싱, 셀렉션

행을 제한하는 경우 = 필터링, 슬라이싱 

​     

```R
people[people$sex==0, ]  # 성별이 0인 레코드의 모든 컬럼 데이터 조회

people[people$sex==0 & people$address=“Busan”, ]  # 성별이 0이고 주소가 부산인 모든 컬럼 조회

people[people$sex==1, “family” ]  # 성별이 1인 관찰치의 family 컬럼만 조회

people[people$sex==1 & people$hour==7 , c(“family”, “job”) ]
# 여러 개의 레코드와 컬럼을 지정해서 조회할 수 있다
     

people[which(people$gender==1), ]  # people 데이터에서 성별이 1인 경우의 행 인덱스 번호를 출력
```

​     



#### 5-1) 탐색적 데이터분석(기술통계량 조회)

​     

```R
dim(데이터명)      # 데이터의 관찰치 개수와 변수 개수 출력(차원 정보)

length(데이터명)   # 데이터의 변수 개수만 출력(데이터의 길이)

length(데이터명$컬럼명)   # 컬럼의 관찰치 개수만 출력
```

​     

```R
str(데이터명)       # 데이터의 관찰치 개수 + 변수 개수 + 각 변수의 데이터 타입 출력

summary(데이터명)   # 각 변수 당 최소값, 최대값, 1~3사분위 수, 평균, NA 개수를 출력
```

​     

```R
library(Hmisc)

describe(데이터명)  # summary( ) 보다 세부적인 기능 제공(범주형 변수를 보여주는데 효과적)
    

library(prettyR)   # R 3.5.1 버전에서는 설치 및 사용 불가(3.1.3 버전은 사용 가능)

describe(데이터명)  # summary( ) 보다 세부적인 기능 제공
```

​     

```R
serach( )  # 패키지별 부착 순서 확인(순번이 낮을수록 먼저 실행되는 패키지)

# describe의 경우 다양한 패키지에서 사용되므로 패키지명::describe( )으로 쓰는 것이 안전하다
```

​     

​     

#### 5-2) 비연속변수(명목척도, 서열척도)의 기술통계량 조회

​     

```R
length(데이터명$컬럼명)      # 컬럼의 전체 레코드 개수

summary(데이터명$컬럼명)     # 컬럼에 있는 데이터들을 집계함 

table(데이터명$컬럼명)       # 컬럼에 있는 데이터들의 빈도를 집계함 

prop.table(데이터명$컬럼명)  # 컬럼에 있는 데이터들의 비율을 계산함

# round(변수, 숫자) 함수를 사용해 객체나 데이터의 소수점을 정리할 수 있음
```

​     

연속변수를 교차표나 빈도표로 나타낸다면 의미가 없습니다. 왜냐하면 연속변수는 넓은 범위를 가지므로, 각 컬럼에 해당하는 데이터의 개수가 적기 때문입니다.

반대로 비연속 변수는 평균의 의미가 없고 중앙값, 최대, 최소값이 더 유의미합니다

​     



#### 5-3) 연속변수(등간척도, 비율척도)의 기술통계량 조회

​     

```R
min(데이터명$컬럼명)

max(데이터명$컬럼명)

range(데이터명$컬럼명)   # 최대값 - 최소값

sort(데이터명$컬럼명)    # 정렬 함수

# sort(데이터명$컬럼명, na.last=TRUE(결측치를 가장 마지막에 정렬), decreasing=T(내림차순 정렬))
```

​     

```R
# 아래 함수는 하나의 벡터만 계산해줍니다(여러 벡터를 사용하려면 summary나 describe 함수 사용)

mean( )      # 평균

median( )    # 중앙값(중간값)

var( )       # 분산

sd( )        # 표준편차

cov( )       # 공분산

cor( )       # 상관계수
```





#### 참고문헌

c강사님의 강의노트

​     

윤종식, 「2017 데이터 분석 준전문가(2017 개정판)」, 제이에스데이타, 2016.

​     

http://rfriend.tistory.com/34



-- 2018.10.04