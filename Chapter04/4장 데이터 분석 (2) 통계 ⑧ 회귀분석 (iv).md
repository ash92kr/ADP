## 4장 데이터 분석 (2) 통계 ⑧ 회귀분석 (iv)

​     

​ 

#### **8) 선형 다중회귀분석**

​ 

다중회귀분석은 하나의 종속변수와 2개 이상의 독립변수들 사이의 관계가 선형이라고 가정하고 회귀선을 찾는 방법입니다.

회귀식의 원형부터 보면  ![default](https://user-images.githubusercontent.com/43332543/47849134-ea36b980-de13-11e8-8f20-37d72fc8d8db.png)이며, 독립변수가 증가할수록  ![bi](https://user-images.githubusercontent.com/43332543/47849120-e7d45f80-de13-11e8-829a-62af00de6588.png)와  ![xi](https://user-images.githubusercontent.com/43332543/47849124-e9058c80-de13-11e8-8923-b8df5fe28770.png)를 추가하면 됩니다.

​     

**① 회귀계수/회귀식(회귀모형)에 대한 가설설정**

기본적인 가설 방식은 선형 단회귀분석과 같습니다. 중회귀분석에서도 회귀계수가 유의한지, 회귀모형이 유의한지 확인합니다. 단회귀분석과 달리 중회귀분석은 각 독립변수의 회귀계수가 유의한지 모두 확인해야합니다. 일부 회귀계수가 유의하지 않아도 회귀식에는 적어야 하며, 해석할 때만 ‘유의하지 않다’고 언급하면 됩니다.

또한 회귀모형의 가설검증도 해석 방식이 달라집니다. 하나의 회귀계수가 유의미하면 회귀모형 전체도 유의미하다는 가설 검증이 됩니다. 모든 회귀계수가 유의미하지 않을 때만 영가설을 선택할 수 있기 때문에 회귀모형 가설 검증은 중요도가 떨어집니다.

​     

![default](https://user-images.githubusercontent.com/43332543/47849133-ea36b980-de13-11e8-9271-7e79b2f02433.png) (모든 독립변수의 계수가 0이다 = 회귀모형은 유의하지 않다)

![default](https://user-images.githubusercontent.com/43332543/47849132-e99e2300-de13-11e8-847a-c0878be58bb2.png)  적어도 1개의 회귀계수는 0이 아니다(모든 독립변수가 쓸모 없지는 않다)

​     

**② 회귀분석표의 해석(SPSS)**     

기본적인 해석 방식은 1번째(독립변수/종속변수) → 4번째(각 회귀계수 유의성 검정) → 3번째(회귀모형 유의성 검정) → 2번째(결정계수/수정된 결정계수)로, 단회귀분석과 같습니다. 그러나 4번째와 2번째 표가 더 중요해집니다.

​     

그 이유는 결정계수 때문입니다. 결정계수가 어떻게 만들어지는지 알아보기 위해 아래 분산분석표를 살펴보겠습니다. 아래 분산분석표는 분산분석에서 본 것과 유사합니다. 다른 부분은 왼쪽의 변량과 R, E로 끝난다는 점입니다. 각 셀의 값을 해석하겠습니다.

​ 

|       요인       | 제곱합 |   자유도   | 평균제곱합 | 분산비 |
| :--------------: | :----: | :--------: | :--------: | :----: |
| **모형(source)** |  SSR   |    1(k)    |    MSR     |   F    |
| **잔차(error)**  |  SSE   | n-2(n-k-1) |    MSE     |        |
|     **전체**     |  SST   |    n-1     |            |        |

​     

가) 회귀식의 적합도

  ![ssr](https://user-images.githubusercontent.com/43332543/47849122-e86cf600-de13-11e8-9cf0-6d5fe66c9592.png) 는 회귀식으로 설명된 편차 

  ![sse](https://user-images.githubusercontent.com/43332543/47849121-e86cf600-de13-11e8-9797-6be46f36ec94.png) 는 회귀식으로 설명이 안 되는 편차(오차)

  ![sst](https://user-images.githubusercontent.com/43332543/47849123-e86cf600-de13-11e8-9615-3a359d4ce884.png) 는 전체 오차

위 **SSR과 SSE**는 회귀식을 통해 추정한  ![y hat](https://user-images.githubusercontent.com/43332543/47849314-75b04a80-de14-11e8-9aa1-b5c186d2383d.png) (y의 예측치)와 실제 y값을 비교하기 위해 만들었습니다.  ![y hat-y bar](https://user-images.githubusercontent.com/43332543/47849313-75b04a80-de14-11e8-9543-a081cded9745.png) 와  ![y-y bar](https://user-images.githubusercontent.com/43332543/47849342-895bb100-de14-11e8-8380-90e4d295d0a2.png)를 비교해 회귀식이 실제값과 더 차이가 적다면 회귀식이 오차를 줄였으며, 이는 데이터의 원래 값을 잘 설명했다는 뜻입니다. 하지만 여전히 설명되지 않는 부분( ![y-y hat](https://user-images.githubusercontent.com/43332543/47849128-e9058c80-de13-11e8-8eab-e71f5da1df18.png))이 남으며, 그것이 잔차입니다.

따라서 회귀식이 데이터의 변동을 모두 설명할 수 있으면, 설명이 안 되는 부분인 잔차는 0이 되므로 SSR이 차지하는 비율이 높다면 회귀모형의 적합도가 높습니다.

​     

자유도 : 분산분석의 k가 집단 개수였다면, 회귀분석의 k는 독립변수의 개수입니다. 

MSR은 SSR을 자유도로 나누었으므로 독립변수 1개당 얼마나 잔차를 줄였는지 평균적으로 나타내는 값입니다.

MSE는 여전히 남는 잔차를 전체 표본의 개수로 나누었으므로 1개의 표본 당 얼마의 잔차가 있는지 보여줍니다.

F값은 회귀모형을 통해 줄인 편차가 남아있는 잔차보다 얼마나 큰지 나타내는 값으로, F값이 커야 모형의 의미가 있습니다. 관찰 F값 > 기준 F값인 경우 영가설을 기각하고 대안가설을 채택하므로 회귀모형은 적합합니다.

​     

나) 적합된 회귀식의 타당성 - 종속변수가 적합된 회귀식에 의해 얼마나 설명되는가?

이를 살펴보기 위해 2번째 표의 **결정계수(R²)**를 봐야 합니다. 결정계수는 총 변동 SST 중 회귀식으로 설명할 수 있는 변동 SSR의 비율을 나타냅니다.

  ![default](https://user-images.githubusercontent.com/43332543/47849129-e99e2300-de13-11e8-818d-3600565fa77d.png) (단회귀분석에서 결정계수는 상관계수의 제곱이다)

상관계수(-1 ~ +1)의 제곱이 결정계수이므로 결정계수는 항상  0 ~ 1 사이에 있습니다. 결정계수가 1에 가까울수록 회귀식 주위에 실제 데이터들이 밀집해 있거나 회귀식이 잘 추정되어 데이터를 잘 설명할 수 있다는 뜻입니다.

​ 

결정계수를 해석하면 ‘회귀모형은 종속변수의 분산을 약 X% 정도로 설명한다’입니다. 참고로 인간과 사회현상을 다루면 결정계수가 0.3~0.4 정도여도 높은 수치지만, 과학현상에서는 이보다 더 높은 결정계수를 기준으로 합니다.

**수정된 결정계수** : 독립변수의 유의성과 별개로 일단 회귀식을 만들면 그 회귀식은 설명력을 가집니다. 문제는 독립변수의 수가 많아질수록 결정계수는 큰 값을 가지게 됩니다. 즉, 종속변수를 잘 설명하기 위해 조사한 모든 독립변수를 넣고 회귀분석을 하면 결정계수는 높아집니다.

이런 경우 결정계수만으로 회귀모형을 비교하면 어떤 회귀식이 정말로 좋은지 알 수 없습니다. 그래서 종속변수에 큰 영향을 끼치지 않는 독립변수를 추가해도 R²이 커지는 것을 막기 위해 수정결정계수(adj R²)를 사용합니다.

​ 

**③ 회귀계수의 유의성 검정 및 회귀모형의 유의성 검정**

​ 

회귀계수가 유의한지 여부를 파악하는 절차는 단회귀분석과 같습니다. 다만 모든 독립변수의 회귀계수가 유의한지 각각 확인해야 합니다. 또한, 회귀모형은 독립변수 중 1개라도 유의미하면 자동으로 유의하다고 나오므로 중회귀분석에서는 중요도가 떨어집니다.

​     

**④ 함수식을 구한 다음, 이를 해석하고 인사이트 찾기**

​ 

![default](https://user-images.githubusercontent.com/43332543/47849134-ea36b980-de13-11e8-8f20-37d72fc8d8db.png)    

중회귀분석의 해석은 독특합니다. 기본적으로 일차함수는 2차원에서 표현되기 때문에 동시에 여러 독립변수를 조작하기 어렵습니다. 즉, 내가 관심있는 독립변수를 변경하면 다른 독립변수는 가만히 있어야 합니다.

즉, 다른 독립변수를 통제한 상태에서 내가 관심있는 독립변수를 바꿀 때 얼마나 종속변수가 변화하는지 살펴봐야 합니다. 따라서 **‘나머지 독립변수가 같을 때(통제할 때), 내가 관심 있는 독립변수가 1단위 증가하면 평균적으로 회귀계수만큼 종속변수가 변화한다.’**고 해석합니다.

만약 특정 독립변수의 회귀계수가 유의미하지 않다면 다음과 같이 해석합니다. **‘해당 독립변수는 종속변수에 통계적으로 유의한 영향을 끼치지 않는다.’** 그래서 회귀계수가 유의하지 않아도 회귀식에서 해당 독립변수를 제외하면 안 됩니다.


​ 

​ 


#### 참고문헌

​     

C강사님의 강의노트

L교수님의 통계수업

​     

서민구, 「R을 이용한 데이터 처리&분석 실무」, 길벗, 2014.

이재길, 「R프로그램에 기반한 다변량분석 및 데이터마이닝」, 황소걸음 아카데미, 2016.

이종익, 박민석 편저, 「사회조사분석사 2급 필기」, 시대고시기획, 2014.

최용석, 「R과 함께하는 통계학의 이해」, BigBook, 2014.

​ 

--2018.10.31