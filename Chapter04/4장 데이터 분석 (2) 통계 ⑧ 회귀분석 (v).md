## 4장 데이터 분석 (2) 통계 ⑧ 회귀분석 (v)

​ 

​ 

#### 9) 다중회귀분석에서 고려할 점 ★

​  

**① 다중공선성 ★**

독립변수 사이에는 독립적이어야 합니다.

A독립변수가 B독립변수에 영향을 주면, B독립변수가 종속변수에 미치는 영향력에는 A독립변수의 영향력도 포함되므로 회귀식의 설명력이 저하됩니다. 이를 다중공선성 현상이 발생했다고 부릅니다.

일반적으로 다중공선성 현상이 발생하면 회귀식의 설명력이 낮으며, 특정 독립변수의 회귀계수가 원래 영향력보다 높아집니다. 때문에 다중공선성이 있는지 반드시 확인해야 하며, 다중공선성이 발생하면 조치를 취해야 합니다.

​     

가) 다중공선성 발견법

i) 산점도를 그려 종속변수와 독립변수의 상관성, 독립변수와 독립변수의 상관성이 있는지 확인한다.

ii) 상관분석을 통해 종속변수와 독립변수의 상관계수는 높아야 하며, 독립변수 사이의 상관계수가 낮아야 한다.

각 상관계수의 p-value가 유의한지 확인해서 유의하지 않으면 신경쓰지 않는다. **독립변수 사이의 상관계수가 0.5~0.7 이상이면 다중공선성이 있다**고 해석합니다.

iii) VIF(분산팽창계수)가 낮을수록 다중공선성이 일어날 가능성이 낮습니다. **일반적으로 VIF가 10 이상이면 다중공선성이 있다**고 인식합니다. ( ![vif](https://user-images.githubusercontent.com/43332543/47953182-47ba3a00-dfbd-11e8-8ecd-b9a9c9b98716.png) )

여기서  ![r](https://user-images.githubusercontent.com/43332543/47953181-47ba3a00-dfbd-11e8-8c9d-2d288e106df5.png)은 해당 독립변수를 종속변수로 놓은 회귀식의 결정계수를 의미합니다. VIF가 10이상이 되려면  ![r](https://user-images.githubusercontent.com/43332543/47953181-47ba3a00-dfbd-11e8-8c9d-2d288e106df5.png)  이 0.9 이상이어야 합니다. 즉, 해당 독립변수와 관련 있는 독립변수가 있다면 결정계수가 높아지므로 밀접한 독립변수가 없어야 VIF가 낮습니다.

​     

나) 다중공선성이 발생했을 때의 조치

i) 다중공선성이 발생한 독립변수에 log를 붙여 값을 바꾼다.(로그 변환)

ii) 다중공선성이 발생한 독립변수 중 일부를 제거하는 lasso 회귀분석, 주성분분석(PCA) 회귀분석을 사용한다.

iii) 다중공선성이 발생한 독립변수의 영향력을 줄이는 능형(ridge) 회귀분석을 사용한다.

​     

처음부터 다중공선성을 조사하기보다 먼저 선형 회귀분석을 실시한 다음, 잔차분석이나 VIF를 실시해 결과에 따라 알맞은 조치를 취하면 다중공선성을 해결할 수 있습니다.

​     

② 독립변수 선택 방법

​     

회귀분석에서 어떤 독립변수를 넣을 지는 중요한 문제입니다. 적게 넣으면 회귀 모델의 설명력이 떨어지며, 많이 넣으면 다중공선성이 발생할 가능성이 높아집니다. 때문에 종속변수를 잘 설명할 수 있는 독립변수만을 넣어야 합니다.

이를 자동화하기 위해 R과 같은 통계 소프트웨어는 종속변수에 중요한 독립변수만 가지고 회귀분석을 실시하는 기능이 있습니다.

​     

가) 전진선택법 : 상수항만 있는 회귀모형에 유의미한 변수를 추가하면서 적절한 회귀모형을 선택하는 방법

나) 후진제거법 : 모든 독립변수를 넣은 회귀모형에서 영향력이 적은 독립변수를 하나씩 제거하면서 더 이상 제거할 변수가 없을 때를 최적모형으로 선택하는 방법

다) 단계별 방법 : 모든 독립변수를 넣은 회귀모형에서 영향력이 적은 독립변수를 제거하다가 제거된 독립변수들이 유의미하면 다시 넣는 단계를 반복하다가 더 이상 변화가 없을 때를 최적모형으로 선택하는 방법(전진선택법과 후진제거법을 합쳐 놓은 방법)

​     

일부 독립변수를 제거한 모형의 결정계수는 모든 독립변수를 넣은 회귀모형의 결정계수보다 낮을 수 있습니다. 하지만 모형 전체의 유의성을 나타내는 F값과 p-value가 높아지므로 독립변수가 많으면 변수 선택법을 사용하기 바랍니다.

​     

③ 회귀모형간 비교(AIC, BIC)

여러 회귀모형이 있을 때, 어떤 회귀모형이 더 좋은지 비교해야 합니다. 이때 사용하는 비교법에는 결정계수 및 AIC와 BIC도 있습니다. 결정계수는 높을수록 좋다면, AIC와 BIC는 낮을수록 좋습니다. 

AIC와 BIC를 이해하기 위해서는 우도(likelihood)를 알아야 합니다. 여기서는 각 모형의 우도를 구한 뒤 이를 비교해 p-value가 0.05보다 낮으면 최우추정량(우도함수가 가장 큰 값(y)을 가지는 모수(x))이 큰 모형을 선택한다고만 이해하겠습니다.

AIC와 BIC는 우도 함수 뒤에 무엇인가를 덧붙였습니다. AIC는 독립변수의 개수, BIC는 데이터의 개수에 로그를 취해 붙였습니다. 때문에 AIC와 BIC는 독립변수와 데이터가 많을수록 값이 높아집니다.

우도 함수는 확률분포와 같이 특정 값에서 가장 높은 Y값(확률)을 가지므로 우도 함수 뒤에 붙은 값들은 작아야 합니다. 그래서 AIC와 BIC를 사용하면 독립변수와 데이터의 개수가 적당히 감소하면서도 가장 종속변수를 잘 설명하는 모형을 선택해줍니다.

위의 변수 선택법에서 독립변수들을 추가하거나 제거하는 과정에서도 AIC가 감소하는 방향으로 이루어집니다. 참고로 AIC와 BIC를 더 잘 이해하려면 아래 사이트를 참고하기 바랍니다.

​     

http://rpago.tistory.com/15

http://rpubs.com/Statdoc/204928

​     

④ 교호작용(상호작용) 효과

분산분석에서 설명드린 바와 같이 독립변수가 서로 영향을 주어 종속변수를 잘 설명할 수 없습니다.

다중공선성은 하나의 독립변수가 다른 독립변수를 대신해 설명할 수 있으므로 독립변수를 없애는 방향으로 나갑니다. 교호작용은 여러 독립변수의 항목들을 곱해 하위집단별로 종속변수가 달라지므로 특정 독립변수를 삭제하기 어렵습니다. 그래서 교호작용을 만드는 독립변수들을 : 로 묶어 회귀모형에 넣고 상호작용변수의 유의성을 검정합니다.

​    

#### 참고문헌

​ 

C강사님의 강의노트
L교수님의 통계수업

​ 

서민구, 「R을 이용한 데이터 처리&분석 실무」, 길벗, 2014.
이재길, 「R프로그램에 기반한 다변량분석 및 데이터마이닝」, 황소걸음 아카데미, 2016.
이종익, 박민석 편저, 「사회조사분석사 2급 필기」, 시대고시기획, 2014.
최용석, 「R과 함께하는 통계학의 이해」, BigBook, 2014.

​ 

--2018.11.01