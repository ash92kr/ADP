## 4장 데이터 분석 (2) 통계 ⑧ 회귀분석 (vii)

​ 

​

####  11) 잔차분석 ★

​ 

선형회귀는 선형성, 독립성(비상관성), 정규성, 등분산성을 만족해야 합니다. 하나라도 만족하지 않으면 비선형회귀분석을 사용하거나 선형성을 만족하도록 데이터를 변형합니다.

​     

① **선형성** : 독립변수와 종속변수의 관계가 선형적인가? 직선 관계가 아니라 하나가 변하면 다른 하나도 일정하게 변해야 한다.

​     

가) 독립변수와 종속변수 사이의 산점도를 그려 확인한다

나) 독립변수와 종속변수의 상관계수가 높으면 좋다

다) Residuals vs Fitted(잔차의 산점도)가 무작위성이어야 한다

빨간색 선 주위에 오차가 있지만, 뚜렷한 패턴이 보이지 않아야 한다

↔ 잔차의 패턴(빨간 선)이 증가/감소 직선이거나 곡선으로 나타나면 변수 간 관계가 나타나지 않는다고 해석한다

​     

선형성을 만족하지 않으면 다항 회귀식(독립변수를 제곱, 세제곱해서 넣는다)을 만들거나 일반화 가법모형(GAM)을 사용합니다.

​     

② **독립성** : 독립변수/오차 사이에는 관련성이 없어야 한다

​     

가) 모든 독립변수와 종속변수를 넣은 산점도를 확인한다

나) 독립변수와 독립변수의 상관계수가 낮을수록 좋다

다) 분산팽창지수(VIF)를 사용해 낮을수록 좋다

라) 더빈-왓슨 검정을 실시해 p-value가 0.05 이상이어야 한다(귀무가설을 채택해야 한다)

​     

여기서는 더빈 왓슨(Durban-Watson) 검정을 확인하겠습니다. D-W(더빈-왓슨) 계수는 0~4 사이의 값을 가지며 2에 가까울수록 오차 간에 독립적이라고 정의합니다.(p값이 0.05 이상이면 독립적이다)

​     

독립성을 만족하지 않고 독립변수/오차 간에 상관성이 존재하면 시계열 분석법을 사용합니다. 하나의 독립변수에 시차가 있거나 오차가 특정한 경향을 나타내므로 회귀계수가 과소 추정되기 때문입니다.

​     

③ **정규성** : 종속변수의 분포가 정규분포인가?(연속 변수인 경우만 사용 가능)

종속변수가 0, 1이라면 glm의 binominal 옵션을 넣어 로지스틱 회귀분석이나 생존분석을 사용합니다.

Normal Q-Q는 데이터가 정규분포를 따르는지 보여주는 그래프입니다. 각 데이터가 점선으로 표현된 대각선 위에 있다면 정규분포를 따르고, 데이터에 숫자가 붙어 있다면 그 레코드는 정규분포에서 멀리 떨어졌다는 뜻입니다.

​     

정규분포를 따르지 않는 데이터는 분석 전에 삭제하거나 특정한 값으로 대체합니다. 또는 표준화(scaling)를 통해 이상치의 크기를 줄입니다.

​     

④ **등분산성** : 잔차의 분산은 일정해야 한다

Scale-Location 그래프는 예측한 y값과 표준화 잔차(잔차를 표준화한 값)의 산점도입니다. 빨간색 선이 0에 가까울수록, 잔차가 고르게 퍼져 있을수록 좋습니다. 

​     

잔차의 분산이 0에 가깝지 않은 경우 데이터를 로그, 지수, 루트 변환을 합니다. 또한, 0에서 멀리 떨어져 있어 Scale-Location 그래프에서 데이터에 숫자가 붙어 있다면 이상치일 가능성이 높으므로 삭제합니다.

​     

⑤ **이상치 파악**

​     

가) 상자그림을 그려 파악

나) 잔차분석의 Cook’s Distance, Residuals vs Leverage, Cook’s dist vs Leverage 그래프를 확인한다 → 하나의 그래프에서 이상치로 표시되는 데이터는 다른 그래프에서도 이상치라고 표시될 가능성이 높습니다.

​     

Cook’s Distance : 각 데이터의 쿡의 거리가 짧을수록 좋으며, 지나치게 긴 데이터는 이상치일 가능성이 높습니다.

Residuals vs Leverage : 중앙의 빨간 선 안에 있을수록 좋으며, 이를 벗어나 우상단, 우하단에 있는 데이터는 이상치일 가능성이 높습니다.

Cook’s dist vs Leverage : 데이터가 아래쪽에 위치할수록 좋으며, 위쪽에 위치한 데이터는 이상치일 가능성이 높습니다.

​     

이상치로 확인되고 데이터의 개수가 많은 경우, 해당 데이터를 삭제합니다.

반대로 데이터가 적은 상황에서는 robust 회귀분석, 분위 회귀분석을 이용해 이상치의 중요도를 줄입니다.

​ 

​ 

#### 참고문헌

​ 

C강사님의 강의노트

L교수님의 통계수업

​ 

서민구, 「R을 이용한 데이터 처리&분석 실무」, 길벗, 2014.

이재길, 「R프로그램에 기반한 다변량분석 및 데이터마이닝」, 황소걸음 아카데미, 2016.

이종익, 박민석 편저, 「사회조사분석사 2급 필기」, 시대고시기획, 2014.

최용석, 「R과 함께하는 통계학의 이해」, BigBook, 2014.

​ 

--2018.11.03