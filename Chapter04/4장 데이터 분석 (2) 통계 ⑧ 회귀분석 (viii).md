## 4장 데이터 분석 (2) 통계 ⑧ 회귀분석 (viii)


​ 
​ 

#### 12) 비선형 회귀분석

지금부터는 비선형 회귀분석을 간단하게 살펴보겠습니다. 선형 회귀분석에서는 독립변수들을 +로 연결하는데, 이를 가법 모형이라고 부릅니다. 단순히 연결만 하므로 표준화가 쉽습니다. 반면 *로 연결하면 승법 모형이라고 부르며, 가법 모형보다 회귀모형을 만들거나 해석하기가 어렵습니다.

비선형 회귀분석은 선형 회귀분석에서 선형성을 만족하지 않을 때 사용합니다. 선형성은 독립변수의 움직임에 따라 종속변수가 일정한 패턴으로 움직일 때 만족합니다. 잔차분석에서 잔차(오차)의 평균이 0이 아니거나 분산이 일정하지 않은 경우 비선형 회귀분석을 사용합니다.

​     

**① 다항 회귀분석**

다항 회귀분석은 선형성을 만족하지 않을 때 사용하는 분석법입니다. 독립변수가 여러 개라는 점에서 다중회귀분석과 공통점이 있지만, 차수가 제곱인 항이 있다는 점에서 다중회귀분석과 다릅니다. 다항 회귀분석에서 사용할 수 있는 차수는 무한대까지 가능하지만, 실제로는 3차 항까지만 사용하는 경우가 많습니다. 고차항을 사용할수록 비선형 데이터를 설명하기 쉽지만 과적합(다중공선성)이 발생할 확률이 높아지기 때문입니다.

먼저 선형 회귀식을 만든 다음 설명력이 낮으면 차수를 높여가면서 테스트하는 방법이 좋습니다. 고차 함수가 될수록 해석이 어려워지기 때문입니다.

​     

2차항이 있는 회귀모델의 식은 다음과 같습니다. ![image](https://user-images.githubusercontent.com/43332543/47990519-0a73ba80-e12b-11e8-8d16-9f8e6603b81c.png)  

이와 같이 특정 독립변수를 제곱한 항이 있는 회귀식을 2차 회귀모델이라고 부릅니다. R에서는 독립변수^2라고 쓰기 보다 I(독립변수^2)라고 쓰는 경우가 많습니다.

​     

**② 스플라인 회귀분석 = 국소 회귀분석**

스플라인 회귀분석은 데이터가 비선형일 때, 전체 데이터를 고려한 회귀식이 아니라 부분/구간별로 최적의 회귀선을 구한 뒤, 이를 연결해서 전체 회귀식을 구하는 방법입니다. 

이는 비선형 분포에도 이상치가 있어 전체 회귀선에 영향을 주기 때문에 구간별로 가장 좋은 회귀선을 구하는 것입니다. R에서는 splines 함수를 이용하거나 MARS(earth) 패키지를 이용해서 구합니다.

스플라인 회귀분석은 비선형 회귀분석이므로 구간별로 다항 독립변수를 만듭니다. 이 때 중요한 개념이 매듭(knot)인데, 데이터를 몇 개의 구간으로 나눌지 분석가가 임의로 정할 수 있습니다. 

​     

**③ 자연 스플라인**

스플라인 회귀분석은 다항 회귀분석보다 개선된 방식이지만, 구간을 나누는 경계 부분에서는 오차가 커집니다. 전체 데이터를 관통하지만 데이터 개수가 적거나 말단 부분에서는 신뢰구간이 넓어져 신뢰도가 낮아집니다. 

자연 스플라인은 이를 보정하기 위해 경계 부근에서 회귀식을 연결할 때 선형으로 연결되게 만든 방법입니다. 

​     

**④ 일반화 가법모형**

지금까지는 1개의 회귀식에 모든 독립변수를 넣었으나, 일반화 가법모형은 여러 회귀식을 결합시킨 방법입니다. 단일 회귀모형의 회귀식과 회귀계수가 유의해도 여전히 오차가 존재하기 때문입니다. 예를 들어, 회귀식을 통해 독립변수가 증가하면 종속변수가 증가한다고 해석하더라도 실제로는 종속변수가 감소하는 부분이 있을 수 있습니다. 

그래서 일반화 가법모형에서는 각각의 독립변수마다 예측식을 만들어 이를 연결했습니다. 예를 들어 f(A) + f(B) + f(C)와 같이 전체 회귀식을 만듭니다. 즉 독립변수들을 유연하게 분석가가 조정할 수 있어 generalized(일반화)를 사용했습니다.

일반화 가법모형을 사용하기 좋은 경우는 같은 독립변수에 속하는 종속변수값이 여러 개인 경우입니다. 하나의 독립변수만으로 만든 회귀모형은 설명력이 낮아 독립변수별로 데이터를 나눠 각 변수별로 회귀선을 만들어 붙인 것입니다.

​ 

​ 

#### 참고문헌

​     

C강사님의 강의노트

L교수님의 통계수업

​     

서민구, 「R을 이용한 데이터 처리&분석 실무」, 길벗, 2014.

이재길, 「R프로그램에 기반한 다변량분석 및 데이터마이닝」, 황소걸음 아카데미, 2016.

이종익, 박민석 편저, 「사회조사분석사 2급 필기」, 시대고시기획, 2014.

최용석, 「R과 함께하는 통계학의 이해」, BigBook, 2014.

​ 

--2018.11.04

